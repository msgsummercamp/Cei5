<div class="mt-7 mx-2 employee-case-table">
  <p-table
    #dt
    [value]="cases"
    dataKey="id"
    [paginator]="true"
    [rows]="10"
    [rowsPerPageOptions]="[5, 10, 20]"
    [loading]="loading"
    [customSort]="true"
    (sortFunction)="customSort($event)"
    [globalFilterFields]="['id', 'date', 'flightNumber', 'clientName', 'employeeName', 'status']"
  >
    <ng-template #header>
      <tr>
        <th>
          <div class="flex align-items-center"
            >{{ 'case-table.case-id' | translate }}
            <p-columnFilter
              type="text"
              field="id"
              display="menu"
              placeholder="{{ 'case-table.search-by-id' | translate }}"
              ariaLabel="search-by-id"
              [showAddButton]="false"
              [showOperator]="false"
            /> </div
        ></th>
        <th pSortableColumn="date"
          ><div class="flex align-items-center"
            >{{ 'case-table.created-on' | translate }} &nbsp; <p-sortIcon field="date" /></div
        ></th>
        <th>{{ 'case-table.flight-number' | translate }}</th>
        <th pSortableColumn="clientName"
          ><div class="flex align-items-center"
            >{{ 'case-table.client-name' | translate }} &nbsp;
            <p-sortIcon field="clientName" /> &nbsp;
            <p-columnFilter
              type="text"
              field="clientName"
              display="menu"
              placeholder="{{ 'case-table.search-by-name' | translate }}"
              ariaLabel="search-by-name"
              [showAddButton]="false"
              [showOperator]="false" /></div
        ></th>
        <th>{{ 'case-table.assigned-employee' | translate }}</th>
        <th
          ><div class="flex align-items-center"
            >{{ 'case-table.status' | translate }}
            <p-columnFilter
              field="status"
              matchMode="equals"
              display="menu"
              [showAddButton]="false"
              [showOperator]="false"
              [showMatchModes]="false"
              [showApplyButton]="false"
              [showClearButton]="false"
            >
              <ng-template #filter let-filter="filterCallback">
                <p-select
                  [(ngModel)]="statusFilterValue"
                  [options]="statusOptions"
                  (onChange)="filter($event.value)"
                  (onClear)="onStatusFilterClear()"
                  [showClear]="true"
                  placeholder="{{ 'case-table.select-status' | translate }}"
                  class="w-full"
                >
                  <ng-template let-option #item>
                    <p-tag
                      [value]="option.label"
                      [severity]="getStatusSeverity(option.value)"
                    ></p-tag>
                  </ng-template>
                </p-select>
              </ng-template> </p-columnFilter></div
        ></th>
        <th style="width: 5rem"></th>
      </tr>
      <tr> </tr>
    </ng-template>
    <ng-template #body let-case>
      <tr>
        <td
          ><p-button icon="pi pi-eye" severity="contrast" [rounded]="true" [outlined]="true" />
          &nbsp;
          {{ case.id }}</td
        >
        <td>{{ case.date }}</td>
        <td>{{ case.problemFlightNumber }}</td>
        <td>{{ case.clientName }}</td>
        <td>{{ case.employeeName }}</td>
        <td>
          <p-tag
            [value]="getStatusTranslation(case.status)"
            [severity]="getStatusSeverity(case.status)"
          />
        </td>
        <td>
          <p-button
            icon="pi pi-trash"
            severity="danger"
            [rounded]="true"
            [outlined]="true"
            (click)="deleteCase(case.id)"
          /> </td
      ></tr>
    </ng-template>
    <ng-template #emptymessage>
      <tr>
        <td colspan="7" class="text-center">
          {{ 'case-table.no-cases-found' | translate }}
        </td>
      </tr>
    </ng-template>
  </p-table>
  <p-confirm-dialog
    header="{{ 'case-table.confirmation' | translate }}"
    icon="pi pi-exclamation-triangle"
  >
  </p-confirm-dialog>
</div>
